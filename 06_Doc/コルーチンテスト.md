# Testing Coroutine
## runTest
  - テスト用コルーチンビルダー
  - 原則、runTestでテストケースをラップする

## TestDispatcher
- StandardTestDispatcher
  - 通常のコルーチンの動きに近い
    - コルーチンブロックがすぐに実行はされない
    - スレッドが空いたタイミングで実行される
  - runTestのデフォルトのDispatcher
- UnconfinedTestDispatcher
  - 積極的にコルーチンブロックが実行される
    - ただしdelay などの遅延処理が入る場合、中断される

## MainDispatcher
- ローカル単体テストでは、使用できない。(JVM上で動くため)
- Dispatcher.setMainで置き換えが必要!

# Testing Flow

### first()
Flow への最初の出力を使用できます。この関数は、最初のアイテムを受け取るまで待機し、その後キャンセル信号をプロデューサに送信します。

### toList()
これにより、Flow はソースからすべての値が出力されるのを待ってから、一連の値をリストとして返します。これは、有限個のデータ ストリームに対してのみ有効です。

> [!WARNING]
> 完了しないflowをテストする場合、TestScope.backgroundScopeを利用すること
> - runTestがflowの完了を待ってしまいテストが終了しない
> - **backgroundScope**はrunTest終了前にコルーチンを終了させる

## Testing stateFlow
stateFlowをテストする場合、少なくとも1つのcollectorが必要